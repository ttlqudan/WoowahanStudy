# 모듈성

- 코드 재사용 메커니즘은 제각각이지만 '모듈'로 묶는 방법이 일반적
    - 아키텍처를 분석해야할 많은 도구가 모듈성에 기반한다 (메트릭, 피트니스 함수, 시각화 등)
    - 모듈성은 일종의 구성원리 (organizing principle)
- 코드베이스 잘 발전을 위해 (암묵적으로) 질서와 일관성이 필요

## 3.1 정의
- 사전적 정의: 복잡한 구조를 만드는 데 쓰이는 각각의 표준화한 부품이나 독립적인 단위
    - 아키텍처를 논할 때, 클래스+함수 등 코드를 묶어놓은 덩어리를 모듈성이라는 언어로 나타냄
    - 논리적 구분이지 물리적인 구분은 아님
-  아키텍트는 개발자가 코드를 어떻게 패키징하는지 반드시 알아야 함
    - 아키텍처에 중요한 영향을 미치기 때문
    - 여러 패키지가 서로 단단히 커플링되어 있으면 그 중 하나를 다른 작업에 재사용하기가 아주 어려워짐
    - 네임스페이스(namespace)를 사용하여 이름의 충돌을 방지(자바, 닷넷 등)

## 3.2 모듈성 측정
- 응집, 커플링, 커네이선스 집중 살펴봄
### 3.2.1 응집 (cohesion)
- 한 모듈의 파트(구성요소)가 동일한 모듈 안에 얼마나 포함되어 있는지 (모듈을 구성하는 파트가 얼마나 연관)
- 응집도의 측정범위: 아래 가장 좋음 -> 나쁜순으로 나열
    - 기능적functional 응집: 기능상 꼭 필요한 것
    - 순차적sequential 응집: 한쪽이 데이터를 출력하면 다른 한쪽이 그것을 입력받는 형식
    - 소통적communication 응집: 통신 체인을 형성 (예: 데이터베이스에 레코드를 추가하면 그 정보에 따라 이메일이 만들어지는 식)
    - 절차적procedural 응집: 정해진 순서대로 실행
    - 일시적temporal 응집: 시점 의존성에 따라 연관
    - 논리적logical 응집: 기능적이 아니라 논리적 연관(String Utils)
    - 동시적coincidental 응집: 같은 소스 파일에 모듈 구성 요소가 들어 있지만 아무 연관성 없음
- LCOM 메트릭을 활용하면 어쩔 수 없이 커플링된 클래스, 처음부터 한 클래스가 아니었던 클래스를 발견하는데 도움
### 3.2.2 커플링
- 그래프 이론에 기반한 좋은 도구 많음 (sonarqube)
- 3.2.3 -> 추상도, 불안정도, 메인 시퀀스로부터의 거리관련 수식

### 3.2.5 커네이선스
- 변화 종속성, 어느 한쪽을 바꾸면 다른쪽도 바뀌어야 정합성이 유지되는 상태

#### 정적 커네이선스
- 코드 레벨의 커플링
  - 명칭 커네이선스: 엔티티명이 일치, 메서드명
  - 타입 커네이선스: 엔티티 타입이 일치
  - 의미 또는 관례 커네이선스: 어떤 값의 의미가 일치
  - 위치 커네이선스: 값의 순서가 일치
  - 알고리즘 커네이선스: 특정 알고리즘이 일치 (보안 해시 알고리즘)

#### 동적 커네이선스
- 런타임 호출을 분석하는 유형의 커네이선스 (동적 커네이선스는 분석이 쉽지 않음)
  - 실행 커네이선스: 실행 순서가 중요
  - 시점 커네이선스: 실행 시점이 중요(두 스레드의 경합)
  - 값 커네이선스: 상호 연관된 다수의 값들을 함께 변경할 때 발생(트랜잭션)
  - 식별 커네이선스: 동일한 엔티티를 참조할 때 발생(분산큐)

#### 커네이선스 속성
- 강도: 얼마나 쉽게 리팩터링 가능한가
  - 정적 커네이선스의 경우 분석도구를 사용하여 개선 가능 => 아키텍트는 동적 커네이선스보다 정적 커네이선스를 선호
- 지역성: 코드베이스의 모듈들이 얼마나 가까이 있는지
- 정도: 커네이선스가 미치는 영향의 규모(소수 혹은 다수의 클래스에 영향을 미치는가)
- 시스템의 모듈성을 개선하는 세 가지 방식
  1. 시스템을 캡슐화한 요소들로 잘게 나누어 전체 커네이선스를 최소화
  2. 캡슐화의 경계를 벗어나는 나머지 커네이선스를 모조리 최소화
  3. 캡슐화 경계 내부에서 커네이선스를 최소화

## 정리
- 모듈에서 컴포넌트로!


## 추가 참고
- https://docs.sonarsource.com/sonarqube/latest/user-guide/metric-definitions/